CREATE TABLE user (user_id INT AUTO_INCREMENT NOT NULL, language_id INT DEFAULT NULL, organization_id INT DEFAULT NULL, username VARCHAR(45) NOT NULL, email VARCHAR(45) DEFAULT NULL, password VARCHAR(200) NOT NULL, first_name VARCHAR(45) DEFAULT NULL, last_name VARCHAR(45) DEFAULT NULL, display_name VARCHAR(45) DEFAULT NULL, address VARCHAR(150) DEFAULT NULL, zip VARCHAR(15) DEFAULT NULL, city VARCHAR(50) DEFAULT NULL, phone1 VARCHAR(50) DEFAULT NULL, phone2 VARCHAR(50) DEFAULT NULL, date_add DATETIME DEFAULT NULL, security_key VARCHAR(255) DEFAULT NULL, date_update DATETIME DEFAULT NULL, date_last_login DATETIME DEFAULT NULL, superior_id INT DEFAULT NULL, state INT NOT NULL, INDEX IDX_8D93D64982F1BAF4 (language_id), INDEX IDX_8D93D64932C8A3DE (organization_id), PRIMARY KEY(user_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE user_role_linker (user_id INT NOT NULL, role_id VARCHAR(255) NOT NULL, INDEX IDX_61117899A76ED395 (user_id), INDEX IDX_61117899D60322AC (role_id), PRIMARY KEY(user_id, role_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE user_role (role_id VARCHAR(255) NOT NULL, parent_id VARCHAR(255) DEFAULT NULL, is_default TINYINT(1) DEFAULT NULL, INDEX IDX_2DE8C6A3727ACA70 (parent_id), PRIMARY KEY(role_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE attachment (attachment_id INT AUTO_INCREMENT NOT NULL, title VARCHAR(200) DEFAULT NULL, description LONGTEXT DEFAULT NULL, file VARCHAR(200) DEFAULT NULL, author VARCHAR(100) DEFAULT NULL, PRIMARY KEY(attachment_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE country (country_id INT AUTO_INCREMENT NOT NULL, name VARCHAR(150) NOT NULL, iso_code VARCHAR(3) NOT NULL, status VARCHAR(20) NOT NULL, INDEX country_iso_code (iso_code), PRIMARY KEY(country_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE language (language_id INT AUTO_INCREMENT NOT NULL, name VARCHAR(255) NOT NULL, isocode VARCHAR(2) NOT NULL, status VARCHAR(20) NOT NULL, date_add DATETIME NOT NULL, date_update DATETIME NOT NULL, PRIMARY KEY(language_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE organization (organization_id INT AUTO_INCREMENT NOT NULL, country_id INT DEFAULT NULL, name VARCHAR(45) DEFAULT NULL, type VARCHAR(50) DEFAULT NULL, slug VARCHAR(45) DEFAULT NULL, description VARCHAR(45) DEFAULT NULL, address VARCHAR(45) DEFAULT NULL, city VARCHAR(45) DEFAULT NULL, status VARCHAR(45) DEFAULT NULL, phone VARCHAR(45) DEFAULT NULL, zip VARCHAR(20) DEFAULT NULL, contact_person VARCHAR(150) DEFAULT NULL, email VARCHAR(200) DEFAULT NULL, fax VARCHAR(45) DEFAULT NULL, url VARCHAR(200) DEFAULT NULL, date_add DATETIME DEFAULT NULL, date_update DATETIME DEFAULT NULL, INDEX IDX_C1EE637CF92F3E70 (country_id), PRIMARY KEY(organization_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE equipment_stock (equipment_stock_id INT AUTO_INCREMENT NOT NULL, equipment_id INT DEFAULT NULL, code VARCHAR(45) NOT NULL, date_add VARCHAR(45) NOT NULL, date_update VARCHAR(45) NOT NULL, INDEX IDX_A26F7784517FE9FE (equipment_id), PRIMARY KEY(equipment_stock_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE equipment (equipment_id INT AUTO_INCREMENT NOT NULL, vendor_id INT DEFAULT NULL, manufacturer_id INT DEFAULT NULL, owner_id INT DEFAULT NULL, user_id INT DEFAULT NULL, title VARCHAR(45) DEFAULT NULL, code VARCHAR(45) DEFAULT NULL, description LONGTEXT DEFAULT NULL, `order` INT DEFAULT NULL, status VARCHAR(45) DEFAULT NULL, date_add DATETIME DEFAULT NULL, date_update DATETIME DEFAULT NULL, feature_image VARCHAR(200) DEFAULT NULL, control_interval_days INT DEFAULT NULL, INDEX IDX_D338D583F603EE73 (vendor_id), INDEX IDX_D338D583A23B42D (manufacturer_id), INDEX IDX_D338D5837E3C61F9 (owner_id), INDEX IDX_D338D583A76ED395 (user_id), PRIMARY KEY(equipment_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE equipment_taxonomy_relationship (equipment_id INT NOT NULL, equipment_taxonomy_id INT NOT NULL, INDEX IDX_7B22F69F517FE9FE (equipment_id), INDEX IDX_7B22F69FF41512D1 (equipment_taxonomy_id), PRIMARY KEY(equipment_id, equipment_taxonomy_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE equipment_instance (equipment_instance_id INT AUTO_INCREMENT NOT NULL, owner INT DEFAULT NULL, equipment_id INT DEFAULT NULL, location INT DEFAULT NULL, usage_status INT DEFAULT NULL, serial_number VARCHAR(50) NOT NULL, reg_number VARCHAR(50) DEFAULT NULL, batch_number VARCHAR(50) DEFAULT NULL, certificate_number VARCHAR(50) DEFAULT NULL, purchase_date DATETIME DEFAULT NULL, technical_lifetime DATETIME DEFAULT NULL, guarantee_time DATETIME DEFAULT NULL, reception_control DATETIME DEFAULT NULL, periodic_control_date DATETIME DEFAULT NULL, control_status VARCHAR(50) DEFAULT NULL, visual_control VARCHAR(1) DEFAULT NULL, order_number VARCHAR(100) DEFAULT NULL, remarks LONGTEXT DEFAULT NULL, status VARCHAR(20) DEFAULT NULL, parent_id INT DEFAULT NULL, INDEX IDX_72F335F8CF60E67C (owner), INDEX IDX_72F335F8517FE9FE (equipment_id), INDEX IDX_72F335F85E9E89CB (location), INDEX IDX_72F335F8218F7464 (usage_status), PRIMARY KEY(equipment_instance_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE equipmentmeta (equipmentmeta_id INT AUTO_INCREMENT NOT NULL, equipment_id INT DEFAULT NULL, `key` VARCHAR(50) NOT NULL, value LONGTEXT NOT NULL, date_add DATETIME NOT NULL, INDEX IDX_AB19C5AE517FE9FE (equipment_id), PRIMARY KEY(equipmentmeta_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE base_taxonomy (base_taxonomy_id INT AUTO_INCREMENT NOT NULL, type VARCHAR(45) DEFAULT NULL, parent_id INT DEFAULT NULL, name VARCHAR(45) DEFAULT NULL, slug VARCHAR(45) DEFAULT NULL, description LONGTEXT DEFAULT NULL, `order` INT DEFAULT NULL, status VARCHAR(20) DEFAULT NULL, PRIMARY KEY(base_taxonomy_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE equipment_taxonomy (equipment_taxonomy_id INT AUTO_INCREMENT NOT NULL, type VARCHAR(45) DEFAULT NULL, parent_id INT DEFAULT NULL, name VARCHAR(45) DEFAULT NULL, description LONGTEXT DEFAULT NULL, path VARCHAR(45) DEFAULT NULL, `order` INT DEFAULT NULL, `status` VARCHAR(20) DEFAULT NULL, children_count INT DEFAULT NULL, featured_image VARCHAR(200) DEFAULT NULL, date_add DATETIME DEFAULT NULL, date_update DATETIME DEFAULT NULL, PRIMARY KEY(equipment_taxonomy_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE equipment_attachment (attachment_id INT AUTO_INCREMENT NOT NULL, equipment_id INT DEFAULT NULL, title VARCHAR(200) DEFAULT NULL, description LONGTEXT DEFAULT NULL, file VARCHAR(200) DEFAULT NULL, author VARCHAR(100) DEFAULT NULL, INDEX IDX_50542D65517FE9FE (equipment_id), PRIMARY KEY(attachment_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE equipment_instance_attachment (attachment_id INT AUTO_INCREMENT NOT NULL, equipment_instance_id INT DEFAULT NULL, title VARCHAR(200) DEFAULT NULL, description LONGTEXT DEFAULT NULL, file VARCHAR(200) DEFAULT NULL, author VARCHAR(100) DEFAULT NULL, INDEX IDX_E6C08F245B13863A (equipment_instance_id), PRIMARY KEY(attachment_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
ALTER TABLE user ADD CONSTRAINT FK_8D93D64982F1BAF4 FOREIGN KEY (language_id) REFERENCES language (language_id);
ALTER TABLE user ADD CONSTRAINT FK_8D93D64932C8A3DE FOREIGN KEY (organization_id) REFERENCES organization (organization_id);
ALTER TABLE user_role_linker ADD CONSTRAINT FK_61117899A76ED395 FOREIGN KEY (user_id) REFERENCES user (user_id);
ALTER TABLE user_role_linker ADD CONSTRAINT FK_61117899D60322AC FOREIGN KEY (role_id) REFERENCES user_role (role_id);
ALTER TABLE user_role ADD CONSTRAINT FK_2DE8C6A3727ACA70 FOREIGN KEY (parent_id) REFERENCES user_role (role_id);
ALTER TABLE organization ADD CONSTRAINT FK_C1EE637CF92F3E70 FOREIGN KEY (country_id) REFERENCES country (country_id);
ALTER TABLE equipment_stock ADD CONSTRAINT FK_A26F7784517FE9FE FOREIGN KEY (equipment_id) REFERENCES equipment (equipment_id);
ALTER TABLE equipment ADD CONSTRAINT FK_D338D583F603EE73 FOREIGN KEY (vendor_id) REFERENCES organization (organization_id);
ALTER TABLE equipment ADD CONSTRAINT FK_D338D583A23B42D FOREIGN KEY (manufacturer_id) REFERENCES organization (organization_id);
ALTER TABLE equipment ADD CONSTRAINT FK_D338D5837E3C61F9 FOREIGN KEY (owner_id) REFERENCES organization (organization_id);
ALTER TABLE equipment ADD CONSTRAINT FK_D338D583A76ED395 FOREIGN KEY (user_id) REFERENCES user (user_id);
ALTER TABLE equipment_taxonomy_relationship ADD CONSTRAINT FK_7B22F69F517FE9FE FOREIGN KEY (equipment_id) REFERENCES equipment (equipment_id);
ALTER TABLE equipment_taxonomy_relationship ADD CONSTRAINT FK_7B22F69FF41512D1 FOREIGN KEY (equipment_taxonomy_id) REFERENCES equipment_taxonomy (equipment_taxonomy_id);
ALTER TABLE equipment_instance ADD CONSTRAINT FK_72F335F8CF60E67C FOREIGN KEY (owner) REFERENCES organization (organization_id);
ALTER TABLE equipment_instance ADD CONSTRAINT FK_72F335F8517FE9FE FOREIGN KEY (equipment_id) REFERENCES equipment (equipment_id);
ALTER TABLE equipment_instance ADD CONSTRAINT FK_72F335F85E9E89CB FOREIGN KEY (location) REFERENCES base_taxonomy (base_taxonomy_id);
ALTER TABLE equipment_instance ADD CONSTRAINT FK_72F335F8218F7464 FOREIGN KEY (usage_status) REFERENCES base_taxonomy (base_taxonomy_id);
ALTER TABLE equipmentmeta ADD CONSTRAINT FK_AB19C5AE517FE9FE FOREIGN KEY (equipment_id) REFERENCES equipment (equipment_id);
ALTER TABLE equipment_attachment ADD CONSTRAINT FK_50542D65517FE9FE FOREIGN KEY (equipment_id) REFERENCES equipment (equipment_id);
ALTER TABLE equipment_instance_attachment ADD CONSTRAINT FK_E6C08F245B13863A FOREIGN KEY (equipment_instance_id) REFERENCES equipment_instance (equipment_instance_id);
