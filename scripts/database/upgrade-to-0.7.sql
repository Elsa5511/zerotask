CREATE TABLE equipment_exam (quiz_id INT AUTO_INCREMENT NOT NULL, base_on_exercise INT NOT NULL, equipment_id INT NOT NULL, time_limit INT NOT NULL, number_questions INT NOT NULL, name VARCHAR(255) NOT NULL, required_for_pass DOUBLE PRECISION NOT NULL, introduction_text LONGTEXT DEFAULT NULL, INDEX IDX_23F77C08B395FB (base_on_exercise), INDEX IDX_23F77C0517FE9FE (equipment_id), PRIMARY KEY(quiz_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE exam_obligatory_question (exam_id INT NOT NULL, question_id INT NOT NULL, INDEX IDX_502D22F3578D5E91 (exam_id), INDEX IDX_502D22F31E27F6BF (question_id), PRIMARY KEY(exam_id, question_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE equipment_exam_attempt (quiz_attempt_id INT AUTO_INCREMENT NOT NULL, exam_id INT NOT NULL, user_id INT NOT NULL, start_time DATETIME DEFAULT NULL, end_time DATETIME DEFAULT NULL, attempt_date DATETIME DEFAULT NULL, result DOUBLE PRECISION DEFAULT NULL, status VARCHAR(30) NOT NULL, INDEX IDX_B021AC91578D5E91 (exam_id), INDEX IDX_B021AC91A76ED395 (user_id), PRIMARY KEY(quiz_attempt_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE equipment_exam_attempt_question_and_answer (quiz_attempt_question_answer_id INT AUTO_INCREMENT NOT NULL, exam_attempt_id INT DEFAULT NULL, question_id INT DEFAULT NULL, INDEX IDX_3BE3373DA399C43E (exam_attempt_id), INDEX IDX_3BE3373D1E27F6BF (question_id), PRIMARY KEY(quiz_attempt_question_answer_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE exam_attempt_answers_to_question_options (exam_attempt_question_answer_id INT NOT NULL, option_id INT NOT NULL, INDEX IDX_C4D3569BDB05BF7 (exam_attempt_question_answer_id), INDEX IDX_C4D3569BA7C41D6F (option_id), PRIMARY KEY(exam_attempt_question_answer_id, option_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE equipment_exercise_attempt (quiz_attempt_id INT AUTO_INCREMENT NOT NULL, exercise_id INT NOT NULL, user_id INT NOT NULL, attempt_date DATETIME DEFAULT NULL, result DOUBLE PRECISION DEFAULT NULL, status VARCHAR(30) NOT NULL, INDEX IDX_B7E4848FE934951A (exercise_id), INDEX IDX_B7E4848FA76ED395 (user_id), PRIMARY KEY(quiz_attempt_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE equipment_exercise_attempt_question_and_answer (quiz_attempt_question_answer_id INT AUTO_INCREMENT NOT NULL, exercise_attempt_id INT DEFAULT NULL, question_id INT DEFAULT NULL, INDEX IDX_3D7637A3F1E0620B (exercise_attempt_id), INDEX IDX_3D7637A31E27F6BF (question_id), PRIMARY KEY(quiz_attempt_question_answer_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE exercise_attempt_answers_to_question_options (exercise_attempt_question_answer_id INT NOT NULL, option_id INT NOT NULL, INDEX IDX_A1F0268C4FA617EA (exercise_attempt_question_answer_id), INDEX IDX_A1F0268CA7C41D6F (option_id), PRIMARY KEY(exercise_attempt_question_answer_id, option_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE question_option (option_id INT AUTO_INCREMENT NOT NULL, question_id INT DEFAULT NULL, option_text VARCHAR(255) DEFAULT NULL, isCorrect TINYINT(1) DEFAULT NULL, INDEX IDX_5DDB2FB81E27F6BF (question_id), PRIMARY KEY(option_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE question (question_id INT AUTO_INCREMENT NOT NULL, exercise_id INT DEFAULT NULL, subject VARCHAR(255) NOT NULL, explanatory_text LONGTEXT NOT NULL, question_text LONGTEXT NOT NULL, type VARCHAR(255) NOT NULL, image VARCHAR(255) DEFAULT NULL, resource_link VARCHAR(255) DEFAULT NULL, weight INT DEFAULT NULL, INDEX IDX_B6F7494EE934951A (exercise_id), PRIMARY KEY(question_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
ALTER TABLE equipment_exam ADD CONSTRAINT FK_23F77C08B395FB FOREIGN KEY (base_on_exercise) REFERENCES equipment_exercise (quiz_id);
ALTER TABLE equipment_exam ADD CONSTRAINT FK_23F77C0517FE9FE FOREIGN KEY (equipment_id) REFERENCES equipment (equipment_id);
ALTER TABLE exam_obligatory_question ADD CONSTRAINT FK_502D22F3578D5E91 FOREIGN KEY (exam_id) REFERENCES equipment_exam (quiz_id);
ALTER TABLE exam_obligatory_question ADD CONSTRAINT FK_502D22F31E27F6BF FOREIGN KEY (question_id) REFERENCES question (question_id);
ALTER TABLE equipment_exam_attempt ADD CONSTRAINT FK_B021AC91578D5E91 FOREIGN KEY (exam_id) REFERENCES equipment_exam (quiz_id);
ALTER TABLE equipment_exam_attempt ADD CONSTRAINT FK_B021AC91A76ED395 FOREIGN KEY (user_id) REFERENCES user (user_id);
ALTER TABLE equipment_exam_attempt_question_and_answer ADD CONSTRAINT FK_3BE3373DA399C43E FOREIGN KEY (exam_attempt_id) REFERENCES equipment_exam_attempt (quiz_attempt_id) ON DELETE CASCADE;
ALTER TABLE equipment_exam_attempt_question_and_answer ADD CONSTRAINT FK_3BE3373D1E27F6BF FOREIGN KEY (question_id) REFERENCES question (question_id) ON DELETE CASCADE;
ALTER TABLE exam_attempt_answers_to_question_options ADD CONSTRAINT FK_C4D3569BDB05BF7 FOREIGN KEY (exam_attempt_question_answer_id) REFERENCES equipment_exam_attempt_question_and_answer (quiz_attempt_question_answer_id);
ALTER TABLE exam_attempt_answers_to_question_options ADD CONSTRAINT FK_C4D3569BA7C41D6F FOREIGN KEY (option_id) REFERENCES question_option (option_id);
ALTER TABLE equipment_exercise_attempt ADD CONSTRAINT FK_B7E4848FE934951A FOREIGN KEY (exercise_id) REFERENCES equipment_exercise (quiz_id);
ALTER TABLE equipment_exercise_attempt ADD CONSTRAINT FK_B7E4848FA76ED395 FOREIGN KEY (user_id) REFERENCES user (user_id);
ALTER TABLE equipment_exercise_attempt_question_and_answer ADD CONSTRAINT FK_3D7637A3F1E0620B FOREIGN KEY (exercise_attempt_id) REFERENCES equipment_exercise_attempt (quiz_attempt_id) ON DELETE CASCADE;
ALTER TABLE equipment_exercise_attempt_question_and_answer ADD CONSTRAINT FK_3D7637A31E27F6BF FOREIGN KEY (question_id) REFERENCES question (question_id) ON DELETE CASCADE;
ALTER TABLE exercise_attempt_answers_to_question_options ADD CONSTRAINT FK_A1F0268C4FA617EA FOREIGN KEY (exercise_attempt_question_answer_id) REFERENCES equipment_exercise_attempt_question_and_answer (quiz_attempt_question_answer_id);
ALTER TABLE exercise_attempt_answers_to_question_options ADD CONSTRAINT FK_A1F0268CA7C41D6F FOREIGN KEY (option_id) REFERENCES question_option (option_id);
ALTER TABLE question_option ADD CONSTRAINT FK_5DDB2FB81E27F6BF FOREIGN KEY (question_id) REFERENCES question (question_id) ON DELETE CASCADE;
ALTER TABLE question ADD CONSTRAINT FK_B6F7494EE934951A FOREIGN KEY (exercise_id) REFERENCES equipment_exercise (quiz_id) ON DELETE CASCADE;
